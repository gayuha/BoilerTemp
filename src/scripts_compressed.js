const LINE_SIZE=TIMESTAMP_SIZE+SENSOR_COUNT,historyBytes=hexStringToByte(_HISTORY_),POINTS_COUNT=historyBytes.length/LINE_SIZE;function hexStringToByte(e){if(!e)return new Uint8Array;for(var t=[],n=0,o=e.length;n<o;n+=2)t.push(parseInt(e.substr(n,2),16));return new Uint8Array(t)}function parseTime(n){let o=0;for(let e=0,t=1;e<TIMESTAMP_SIZE;e++,t*=256)o+=historyBytes[n+e]*t;return o}function parseTemps(t){let n=[];for(let e=0;e<SENSOR_COUNT;e++)n.push(historyBytes[t+TIMESTAMP_SIZE+e]);return n}function comparePoints(e,t){return e.time<t.time?-1:e.time>t.time?1:0}let historyClean=[];for(let e=0;e<POINTS_COUNT;e++){const o=e*LINE_SIZE,p=parseTime(o),q=parseTemps(o);if(0!=p){let t=!1;for(let e=0;e<q.length;e++)if(157==q[e]){t=!0;break}if(!t){let e={time:1e3*p,temps:q};historyClean.push(e)}}}historyClean.sort(comparePoints);var GLOBAL_DATA=[],INSIDE_DATA=[],TOP_DATA=[];for(let e=0;e<historyClean.length;e++)GLOBAL_DATA.push({x:historyClean[e].time,y:historyClean[e].temps[0]}),INSIDE_DATA.push({x:historyClean[e].time,y:historyClean[e].temps[1]}),TOP_DATA.push({x:historyClean[e].time,y:historyClean[e].temps[2]});const annotationsOpen=_VALVEOPENINGS_.map(function(e,t){return{type:"line",xMin:e,xMax:e,borderColor:"red",label:{content:"Opened",enabled:!0,position:"start"}}}),annotationsClose=_VALVECLOSINGS_.map(function(e,t){return{type:"line",xMin:e,xMax:e,borderColor:"blue",label:{content:"Closed",enabled:!0,position:"start"}}}),annotations=annotationsOpen.concat(annotationsClose);window.onload=function(){document.getElementById("_TEMP1_").innerHTML=_TEMP1_,document.getElementById("_TEMP2_").innerHTML=_TEMP2_,document.getElementById("_TEMP3_").innerHTML=_TEMP3_,document.getElementById("_TEMP1Q_").innerHTML=_TEMP1Q_,document.getElementById("_TEMP2Q_").innerHTML=_TEMP2Q_,document.getElementById("_TEMP3Q_").innerHTML=_TEMP3Q_,document.getElementById("_VALVEOPENED_").innerHTML=_VALVEOPENED_,document.getElementById("_VALVECLOSED_").innerHTML=_VALVECLOSED_,document.getElementById("_VALVESTATUS_").innerHTML=_VALVESTATUS_,document.getElementById("_IP_").innerHTML=_IP_,document.getElementById("_DST_").innerHTML=_DST_,document.getElementById("_TIME_").innerHTML=_TIME_,document.getElementById("_INFO_").innerHTML=_INFO_;var e=document.getElementById("temperatures").getContext("2d");new Chart(e,{type:"line",data:{datasets:[{label:"Global",data:GLOBAL_DATA,borderColor:"red",fill:!1,tension:.4},{label:"Inside",data:INSIDE_DATA,borderColor:"orange",fill:!1,tension:.4},{label:"Top",data:TOP_DATA,borderColor:"purple",fill:!1,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{type:"time",display:!0,time:{displayFormats:{minute:"HH:mm"}}},y:{position:"right"}},plugins:{annotation:{annotations:annotations},zoom:{pan:{enabled:!0,mode:"x",speed:20,threshold:10},zoom:{wheel:{enabled:!0,modifierKey:"ctrl"},drag:{enabled:!0,backgroundColor:"rgba(200, 200, 200, 0.6)",modifierKey:"alt",borderColor:"rgba(127,127,127)",borderWidth:"1"},pinch:{enabled:!0},mode:"x",speed:.1,threshold:2,sensitivity:3},limits:{x:{min:"original",max:"original"}}}}}})};